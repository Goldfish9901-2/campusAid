@startuml

' 主启动类
class CampusAidApplication {
  +static void main(String[] args)
}
CampusAidApplication <|-- SpringApplication : 继承自 Spring Boot 应用

' 控制器层
class LoginController
class RegisterController
class AuthController
class AlipayController
class ComplaintController
class ErrandController
class ForumController
class ShopController
class StockController
class UserController
class ErrorController
class SessionKeys

LoginController -up-|> AuthController : 继承
RegisterController -up-|> AuthController : 继承

' DTO 层
class ApiResponse
class LoginRequest
class RegisterRequest
class VerifyRequest
class OrderDTO
class ProductTransaction
class ShopInfo
class ErrandOrderPreview
class ErrandOrderRequest
class ErrandOrderStatus
class Blog
class ReplyView
class ReportRequest
class Visibility
class KeywordType
class PostSortOrder
class ComplaintBlock
class ComplaintRequest

' 异常处理
class GlobalExceptionHandler
GlobalExceptionHandler "1" o-- "many" ApiController : 全局异常捕获

' 拦截器
class AuthInterceptor
AuthInterceptor --> SessionKeys : 使用会话键值

' Mapper 层
class ChargeMapper
class ComplaintMapper
class ErrandMapper
class ForumMapper
class ShopMapper
class UserMapper
class ExceptionMapper
class ReplyMapper
class LikeBlogMapper
class GoodMapper
class OrderMapper
class TransactionMapper
class BanMapper

' 实体模型
class User
class Charge
class Complaint
class Errand
class LikeBlog
class Reply
class ReplyTreeNode
class Good
class Shop
class ShopOrder

ChargeMapper --> Charge : 映射实体
ComplaintMapper --> Complaint : 映射实体
ErrandMapper --> Errand : 映射实体
ForumMapper --> Blog : 映射实体
ShopMapper --> Shop : 映射实体
UserMapper --> User : 映射实体

' 服务层
class CampusAidException
class UserService
class LoginService
class RegisterService
class MailService
class ChargeService
class ComplaintService
class ErrandService
class ForumPostService
class ShopService
class StockService
class UploadFileSystemService
class ExceptionService

UserService --> UserMapper : 使用 UserMapper
LoginService --> UserMapper : 使用 UserMapper
RegisterService --> UserMapper : 使用 UserMapper
MailService --> UserMapper : 使用 UserMapper
ChargeService --> ChargeMapper : 使用 ChargeMapper
ComplaintService --> ComplaintMapper : 使用 ComplaintMapper
ErrandService --> ErrandMapper : 使用 ErrandMapper
ForumPostService --> ForumMapper : 使用 ForumMapper
ShopService --> ShopMapper : 使用 ShopMapper
StockService --> ShopMapper : 使用 ShopMapper

' 工具类
class BizContentField
class BizContentLoader
class ReplyTreeConverter

ReplyTreeConverter --> Reply : 构建回复树

' 配置类
class WebConfig
class SecurityProperties
class AdminConfig
class AlipayTemplate

WebConfig --> AuthInterceptor : 注册拦截器
SecurityProperties --> WebConfig : 提供配置属性
AlipayTemplate --> ChargeService : 支付配置注入

title 校园互助平台类图（使用官方标准符号）
@enduml
