

# 📘 用户注册与登录接口文档

## 🔐 注册流程

### 1. 发送注册验证码

**URL**：`POST /register`  
**描述**：提交用户信息，请求系统发送验证码到学校邮箱。

#### 请求参数（JSON 格式）：

```json
{
  "name": "张三",
  "id": 2023123456,
  "phoneNumber": 13800001111
}
```

> 邮箱由系统拼接：`${id}@st.usst.edu.cn`

#### 会话写入内容（SessionKeys）：

| Key                    | 值类型    | 说明           |
|------------------------|-----------|----------------|
| `reg_name`             | `String`  | 用户真实姓名   |
| `reg_id`               | `Long`    | 学号           |
| `reg_phone`            | `Long`    | 手机号         |
| `reg_code`             | `String`  | 生成的验证码   |

#### 返回示例：

```json
{
  "code": 200,
  "message": "success",
  "body": "验证码已发送"
}
```

---

### 2. 验证注册验证码

**URL**：`POST /register/verify`  
**描述**：提交验证码，验证通过后完成注册，保存用户至数据库。

#### 请求参数：

| 参数名 | 类型   | 来源     | 说明      |
|--------|--------|----------|-----------|
| code   | String | 表单/JSON | 用户输入验证码 |

#### 会话读取内容（使用 @SessionAttribute）：

| Key         | 类型     | 用途             |
|--------------|----------|------------------|
| `reg_code`   | String   | 验证码验证        |
| `reg_name`   | String   | 构建 User 对象    |
| `reg_id`     | Long     | 构建 User 对象    |
| `reg_phone`  | Long     | 构建 User 对象    |

#### 验证通过后写入：

| Key              | 类型       | 说明               |
|------------------|------------|--------------------|
| `register_time`  | `LocalTime` | 注册成功时间戳     |

#### 成功返回：

```json
{
  "code": 200,
  "message": "success",
  "body": "注册成功"
}
```

---

## 🔐 登录流程

### 1. 请求登录验证码

**URL**：`POST /login`  
**描述**：根据学号请求登录验证码，发送至学校邮箱。

#### 请求参数：

```json
{
  "id": 2023123456
}
```

#### 会话写入内容：

| Key         | 类型   | 说明         |
|-------------|--------|--------------|
| `login_id`  | Long   | 登录学号     |
| `login_code`| String | 生成验证码   |

#### 返回示例：

```json
{
  "code": 200,
  "message": "success",
  "body": "验证码已发送"
}
```

---

### 2. 验证登录验证码

**URL**：`POST /login/verify`  
**描述**：提交验证码，验证通过后登录成功。

#### 请求参数：

```json
{
  "code": "123456"
}
```

#### 会话读取内容：

| Key           | 类型   | 说明        |
|---------------|--------|-------------|
| `login_code`  | String | 服务器验证码 |
| `login_id`    | Long   | 学号        |

#### 写入内容：

| Key               | 类型       | 说明                  |
|-------------------|------------|-----------------------|
| `login_time`      | `LocalTime` | 记录登录成功时间       |

#### 成功返回：

```json
{
  "code": 200,
  "message": "success",
  "body": "登录成功"
}
```

